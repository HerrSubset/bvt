#!/usr/bin/env ruby

require 'bvt'

fed = Bvt.load_federation(ARGV[0])

if fed == nil
  puts "[ERROR] This federation was not found"
  exit
end


#print all league names to the screen
puts "\nAvailable leagues:"
leagues = fed.leagues.sort
(1..(leagues.length)).each do |n|
  puts "#{n}:\t#{leagues[n-1].name}"
end

#let user select league
puts "Enter the number of the league you'd like to select:"
input = $stdin.gets.chomp.to_i
l = leagues[input - 1]
puts "You selected #{l.name}\n"


#print league rankings
ranking = l.get_rankings

#make all team name strings equal in length by adding spaces
longest = 0
ranking.each do |r|
  if r["name"].length > longest
    longest = r["name"].length
  end
end

ranking.each do |r|
  difference = longest - r["name"].length
  r["name"] += " " * difference
end


ranking.each do |r|
  puts "#{r['name']}\t#{r['played']}\t#{r['3_points']}\t#{r['2_points']}\t#{r['1_point']}\t#{r['0_points']}\t#{r['won_sets']}\t#{r['lost_sets']}\t#{r['points']}"
end


puts "\nAvailable teams in #{l.name}:"
team_list = l.get_teams.sort
(1..(team_list.length)).each do |n|
  puts "#{n}:\t#{team_list[n-1]}"
end

puts "Enter the number of the team you'd like to select:"
input = $stdin.gets.chomp.to_i
t = team_list[input - 1]


puts "\nCalendar for #{t}:"
team_games = l.get_team_games(t)

team_games.each do |g|
  puts g.to_s
end
